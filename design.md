# 单位内部饭堂订餐系统设计方案
## 1. 系统架构设计
### 1.1 技术选型
分类 技术 版本 选型理由 前端框架 Vue.js 3.x 轻量级、响应式、组件化开发，适合构建单页应用，移动端适配性好 前端路由 Vue Router 4.x 与Vue.js完美集成，支持SPA路由管理 状态管理 Pinia 2.x 替代Vuex的轻量级状态管理方案，更简洁的API UI组件库 Element Plus 2.x 提供丰富的UI组件，支持响应式设计，文档完善 后端框架 Spring Boot 3.x 快速开发、内嵌容器、自动配置，适合构建RESTful API 持久层框架 MyBatis-Plus 3.x 简化MyBatis开发，提供CRUD操作，支持代码生成 数据库 MySQL 8.0 成熟稳定的关系型数据库，适合存储结构化数据 缓存 Redis 7.0+ 用于缓存热点数据和管理Session/Token 认证框架 Spring Security 6.x 提供完整的认证和授权功能 API文档 Swagger3 3.0+ 自动生成API文档，方便前后端对接 构建工具 Maven 3.8+ 项目管理和依赖管理工具 版本控制 Git - 代码版本管理

### 1.2 系统分层
1. 前端层
   
   - 员工端：订餐、修改订单、删除订单、查看订单历史
   - 厨师端：查看订餐情况、统计分析、数据导出
   - 管理员端：系统配置、用户管理、权限管理、订单管理、统计分析、数据导出
2. 后端API层
   
   - 认证接口：登录、登出、权限验证
   - 订单接口：创建订单、修改订单、删除订单、查询订单
   - 统计接口：订餐统计、数据导出
   - 配置接口：系统配置、用户管理、权限管理
3. 业务逻辑层
   
   - 订单服务：处理订单相关业务逻辑
   - 统计服务：处理数据统计和分析
   - 用户服务：处理用户认证和授权
   - 配置服务：处理系统配置和管理
4. 数据访问层
   
   - 订单DAO：订单数据的CRUD操作
   - 用户DAO：用户数据的CRUD操作
   - 配置DAO：系统配置数据的CRUD操作
   - 日志DAO：操作日志的记录和查询
5. 基础设施层
   
   - 数据库：MySQL
   - 缓存：Redis
   - 消息队列：可选，用于异步处理
   - 文件存储：用于存储导出的Excel文件
### 1.3 模块划分
模块 主要职责 文件位置 前端员工模块 员工订餐、修改订单、删除订单、查看订单历史 src/views/employee/ 前端厨师模块 查看订餐情况、统计分析、数据导出 src/views/chef/ 前端管理员模块 系统配置、用户管理、权限管理 src/views/admin/ 后端认证模块 用户登录、登出、权限验证 src/main/java/com/canteen/auth/ 后端订单模块 订单创建、修改、删除、查询 src/main/java/com/canteen/order/ 后端统计模块 订餐统计、数据导出 src/main/java/com/canteen/statistics/ 后端用户模块 用户管理、权限管理 src/main/java/com/canteen/user/ 后端配置模块 系统配置、订餐类型管理 src/main/java/com/canteen/config/ 后端日志模块 操作日志记录和查询 src/main/java/com/canteen/log/ 后端工具模块 通用工具类、常量定义 src/main/java/com/canteen/common/

## 2. 数据库结构设计
### 2.1 数据库表结构 2.1.1 用户表 ( user )
字段名 数据类型 约束 描述 id BIGINT PRIMARY KEY AUTO_INCREMENT 用户ID username VARCHAR(50) UNIQUE NOT NULL 用户名 password VARCHAR(100) NOT NULL 密码（加密存储） name VARCHAR(50) NOT NULL 姓名 role_id BIGINT NOT NULL REFERENCES role(id) 角色ID department VARCHAR(100) NULL 部门 phone VARCHAR(20) NULL 手机号 email VARCHAR(100) NULL 邮箱 status TINYINT NOT NULL DEFAULT 1 状态（1：启用，0：禁用） created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP 创建时间 updated_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP 更新时间
 2.1.2 角色表 ( role )
字段名 数据类型 约束 描述 id BIGINT PRIMARY KEY AUTO_INCREMENT 角色ID name VARCHAR(50) UNIQUE NOT NULL 角色名称（员工、厨师、管理员） description VARCHAR(200) NULL 角色描述 created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP 创建时间 updated_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP 更新时间
 2.1.3 餐食类型表 ( meal_type )
字段名 数据类型 约束 描述 id BIGINT PRIMARY KEY AUTO_INCREMENT 餐食类型ID name VARCHAR(50) UNIQUE NOT NULL 餐食类型名称（早餐、午餐、晚餐） price DECIMAL(10,2) NOT NULL 价格 status TINYINT NOT NULL DEFAULT 1 状态（1：启用，0：禁用） created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP 创建时间 updated_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP 更新时间
 2.1.4 订餐订单表 ( order )
字段名 数据类型 约束 描述 id BIGINT PRIMARY KEY AUTO_INCREMENT 订单ID user_id BIGINT NOT NULL REFERENCES user(id) 用户ID meal_type_id BIGINT NOT NULL REFERENCES meal_type(id) 餐食类型ID order_date DATE NOT NULL 订餐日期 status TINYINT NOT NULL DEFAULT 1 状态（1：有效，0：无效） created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP 创建时间 updated_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP 更新时间
 2.1.5 操作日志表 ( operation_log )
字段名 数据类型 约束 描述 id BIGINT PRIMARY KEY AUTO_INCREMENT 日志ID user_id BIGINT NOT NULL REFERENCES user(id) 用户ID operation_type VARCHAR(50) NOT NULL 操作类型（订餐、修改订单、删除订单） operation_content VARCHAR(500) NOT NULL 操作内容 operation_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP 操作时间 ip_address VARCHAR(50) NULL IP地址
 2.1.6 系统配置表 ( system_config )
字段名 数据类型 约束 描述 id BIGINT PRIMARY KEY AUTO_INCREMENT 配置ID config_key VARCHAR(100) UNIQUE NOT NULL 配置键（lock_time、system_name等） config_value VARCHAR(500) NOT NULL 配置值 description VARCHAR(200) NULL 配置描述 created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP 创建时间 updated_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP 更新时间

## 3. 用户界面原型设计
### 3.1 员工端界面 
3.1.1 登录页面
- 用户名输入框
- 密码输入框
- 登录按钮
- 忘记密码链接（可选） 
3.1.2 订餐页面
- 日历选择器（标记可预订和不可预订日期）
- 餐食类型选择（早餐、午餐、晚餐）
- 提交订单按钮
- 订单历史记录入口 
3.1.3 订单管理页面
- 订单列表（按日期排序）
- 订单状态显示
- 修改订单按钮
- 删除订单按钮
- 操作日志查看入口
### 3.2 厨师端界面 
3.2.1 登录页面
- 与员工端登录页面类似 
3.2.2 订餐情况页面
- 日期选择器
- 餐食类型分类（早餐、午餐、晚餐）
- 订餐数量统计
- 详细订餐列表（按部门/个人）
3.2.3 统计分析页面
- 时间段选择
- 餐食类型统计图表
- 部门订餐统计图表
- 导出Excel按钮
### 3.3 管理员端界面 
3.3.1 登录页面
- 与员工端登录页面类似 
3.3.2 系统配置页面
- 锁单时间设置（小时/分钟选择器）
- 系统名称设置
3.3.3 餐食类型管理页面
- 餐食类型列表
- 添加餐食类型按钮
- 编辑餐食类型按钮
- 删除餐食类型按钮
- 价格设置 
3.3.4 员工管理页面
- 员工列表
- 添加员工按钮
- 编辑员工按钮
- 删除员工按钮
- 角色分配
- 部门管理 
3.3.5 权限管理页面
- 角色列表
- 添加角色按钮
- 编辑角色按钮
- 删除角色按钮
- 权限分配
## 4. 详细功能规格说明书
### 4.1 员工订餐模块 
4.1.1 在线订餐功能
- 功能描述 ：员工可以通过系统在线预订明天及以后的餐食
- 实现逻辑 ：
  1. 系统获取当前日期和时间
  2. 计算可预订的最早日期（明天）
  3. 检查当前时间是否超过锁单时间
  4. 如果超过锁单时间，则可预订的最早日期为后天
  5. 提供日历选择器，标记可预订和不可预订的日期
  6. 员工选择日期和餐食类型
  7. 系统验证预订条件
  8. 创建订单并记录操作日志 
  4.1.2 智能锁单机制
- 功能描述 ：若当前下单时间晚于当日锁单时间，则系统自动禁止预订明天的餐食，仅允许预订后天及以后的餐食
- 实现逻辑 ：
  1. 系统从配置表中获取锁单时间
  2. 比较当前时间与锁单时间
  3. 如果当前时间 > 锁单时间，则设置可预订的最早日期为后天
  4. 如果当前时间 <= 锁单时间，则设置可预订的最早日期为明天
  5. 在日历选择器中标记可预订和不可预订的日期 
  4.1.3 订单修改功能
- 功能描述 ：员工可以修改已提交的订单，修改权限与初始订餐的限定条件保持一致
- 实现逻辑 ：
  1. 员工选择要修改的订单
  2. 系统验证修改权限（基于锁单时间和预订日期）
  3. 如果有权限，则允许修改订单
  4. 修改完成后，更新订单信息并记录操作日志
  5. 如果无权限，则提示错误信息 
  4.1.4 订单删除功能
- 功能描述 ：员工可以删除已提交的订单，删除权限与初始订餐的限定条件保持一致
- 实现逻辑 ：
  1. 员工选择要删除的订单
  2. 系统验证删除权限（基于锁单时间和预订日期）
  3. 如果有权限，则允许删除订单
  4. 删除完成后，更新订单状态并记录操作日志
  5. 如果无权限，则提示错误信息 
  4.1.5 操作日志记录
- 功能描述 ：所有操作需记录操作日志，包括订餐、修改、删除时间及操作人员信息
- 实现逻辑 ：
  1. 在订单创建、修改、删除操作时，记录操作日志
  2. 日志内容包括：操作类型、操作内容、操作时间、操作人员ID、IP地址等
  3. 提供操作日志查询功能，方便追溯操作历史
### 4.2 厨师工作模块 4.2.1 订餐情况实时查看
- 功能描述 ：厨师可以查看当日和选定日期的订餐情况，按时间段（早餐/午餐/晚餐）分类展示
- 实现逻辑 ：
  1. 提供日期选择器，默认显示当日
  2. 按餐食类型（早餐、午餐、晚餐）分类展示订餐情况
  3. 显示详细的订餐列表，包括员工姓名、部门、订餐类型等信息
  4. 支持按部门或个人筛选 
  4.2.2 订餐统计功能
- 功能描述 ：实现按订餐类型（早餐/午餐/晚餐）自动统计功能，精确显示各类餐食的预订数量
- 实现逻辑 ：
  1. 系统按选定日期和餐食类型统计订餐数量
  2. 以图表或表格形式展示统计结果
  3. 支持按时间段（日/周/月）统计
  4. 支持按部门统计 
  4.2.3 数据导出功能
- 功能描述 ：提供数据导出功能，支持将统计结果导出为Excel格式
- 实现逻辑 ：
  1. 生成Excel文件，包含订餐统计数据
  2. 提供下载链接，方便厨师下载
  3. 导出内容包括：日期、餐食类型、预订数量、详细订餐人员信息等
### 4.3 管理员配置模块 
4.3.1 订餐类型管理
- 功能描述 ：管理员可以添加、编辑、删除早餐、午餐、晚餐等订餐类型和相应价格
- 实现逻辑 ：
  1. 提供餐食类型列表，显示当前所有餐食类型
  2. 支持添加新的餐食类型，包括名称和价格
  3. 支持编辑现有餐食类型的名称和价格
  4. 支持删除不需要的餐食类型
  5. 提供状态管理（启用/禁用） 
  4.3.2 锁单时间设置
- 功能描述 ：管理员可以设置锁单时间，支持精确到小时和分钟的时间配置
- 实现逻辑 ：
  1. 提供时间选择器，支持选择小时和分钟
  2. 保存锁单时间到系统配置表
  3. 系统在处理订餐请求时，使用此配置判断可预订的最早日期 
  4.3.3 员工数据管理
- 功能描述 ：管理员可以添加、编辑、查询和删除员工信息
- 实现逻辑 ：
  1. 提供员工列表，支持分页和搜索
  2. 支持添加新员工，包括姓名、用户名、密码、部门、角色等信息
  3. 支持编辑现有员工的信息
  4. 支持删除员工账号
  5. 支持按部门、角色筛选员工 4.3.4 系统角色权限管理
- 功能描述 ：实现系统角色权限管理，分为员工、厨师、管理员权限
- 实现逻辑 ：
  1. 提供角色列表，显示当前所有角色
  2. 支持添加新角色（可选，默认已有员工、厨师、管理员）
  3. 支持编辑角色名称和描述
  4. 支持删除不需要的角色
  5. 支持为角色分配权限（基于菜单和操作）
### 4.4 系统通用要求 
4.4.1 界面设计
- 要求 ：界面设计需简洁直观，符合用户操作习惯
- 实现 ：
  1. 使用Element Plus UI组件库，保持界面风格一致
  2. 遵循现代Web设计原则，注重用户体验
  3. 合理布局，减少操作步骤
  4. 提供清晰的视觉反馈，如按钮状态、加载动画等 
  4.4.2 响应速度
- 要求 ：页面加载时间不超过2秒，数据提交响应时间不超过1秒
- 实现 ：
  1. 前端使用Vue.js的异步组件和路由懒加载
  2. 后端使用Spring Boot的缓存机制
  3. 数据库优化，如索引设计、查询优化
  4. 使用Redis缓存热点数据
  5. 合理的API设计，减少不必要的数据传输 
  4.4.3 数据备份和恢复
- 要求 ：系统需具备数据备份和恢复功能，确保订餐数据安全
- 实现 ：
  1. 定期自动备份数据库（如每天凌晨）
  2. 提供手动备份功能
  3. 提供数据恢复功能，支持从备份文件恢复数据
  4. 备份文件存储在安全的位置，如云存储或本地备份服务器 4.4.4 多终端访问
- 要求 ：支持多终端访问，包括PC端和移动端适配
- 实现 ：
  1. 前端使用响应式设计，适配不同屏幕尺寸
  2. 使用Element Plus的响应式组件
  3. 移动端优化，如触摸操作、手势支持
  4. 确保在PC端和移动端都有良好的用户体验 
  4.4.5 用户登录认证
- 要求 ：实现用户登录认证功能，不同角色（员工/厨师/管理员）拥有不同操作权限
- 实现 ：
  1. 使用Spring Security实现用户认证和授权
  2. 基于角色的权限控制（RBAC）
  3. 登录成功后，生成JWT令牌，用于后续请求的认证
  4. 实现令牌过期和刷新机制
  5. 前端存储令牌，在请求头中携带令牌
### 4.5 非功能性需求 4.5.1 系统稳定性
- 要求 ：保证99.9%以上的可用性
- 实现 ：
  1. 使用Spring Boot的内嵌容器，减少外部依赖
  2. 实现错误处理和异常捕获机制
  5. 合理的系统架构设计，避免单点故障 
  4.5.2 可扩展性
- 要求 ：系统架构需支持未来功能扩展
- 实现 ：
  1. 使用模块化设计，便于功能扩展
  2. 采用RESTful API设计，便于前后端分离和扩展
  3. 使用MyBatis-Plus，支持代码生成和快速开发
  4. 预留扩展接口，如第三方系统集成、支付功能等 4.5.3 易用性
- 要求 ：员工端操作步骤不超过3步即可完成订餐
- 实现 ：
  1. 简化订餐流程，减少操作步骤
  2. 提供直观的日历选择器和餐食类型选择
  3. 优化界面布局，减少视觉干扰
  4. 提供清晰的操作提示和反馈
  5. 支持快捷操作，如默认选择常用餐食类型
## 5. 系统部署与维护
### 5.1 部署方案
1. 开发环境
   
   - 前端：Vue CLI开发服务器
   - 后端：Spring Boot内嵌Tomcat
   - 数据库：本地MySQL
2. 测试环境
   
   - 前端：部署到测试服务器（如Nginx）
   - 后端：部署到测试服务器（如Tomcat）
   - 数据库：测试环境MySQL
3. 生产环境
   
   - 前端：部署到生产服务器（如Nginx），开启Gzip压缩和缓存
   - 后端：部署到生产服务器（如Tomcat），配置负载均衡
   - 数据库：生产环境MySQL，配置主从复制
   - 缓存：Redis集群
   - 监控：配置系统监控和告警机制
### 5.2 维护方案
1. 日常维护
   
   - 定期检查系统运行状态
   - 定期备份数据库
   - 监控系统性能和日志
   - 处理用户反馈和问题
2. 版本更新
   
   - 制定版本更新计划
   - 测试新版本功能
   - 灰度发布
   - 回滚机制
3. 故障处理
   
   - 建立故障处理流程
   - 快速定位和解决问题
   - 记录故障原因和解决方案
   - 持续优化系统稳定性
## 6. 总结
本设计方案基于单位内部饭堂订餐系统的需求，设计了一套完整的系统架构、数据库结构、用户界面原型和功能规格说明书。系统采用前后端分离的架构，前端使用Vue.js和Element Plus，后端使用Spring Boot和MyBatis-Plus，数据库使用MySQL，确保系统的稳定性、可扩展性和易用性。

系统实现了员工订餐、厨师工作、管理员配置三大核心模块，满足了在线订餐、智能锁单、订单管理、订餐统计、系统配置等功能需求。同时，系统还具备数据备份和恢复、多终端访问、用户登录认证等通用要求，以及99.9%以上的可用性、支持未来功能扩展、员工端操作步骤不超过3步等非功能性需求。

本设计方案为系统开发提供了详细的技术文档和实现指导，确保系统能够满足单位内部饭堂订餐的实际需求，提高订餐效率和管理水平。