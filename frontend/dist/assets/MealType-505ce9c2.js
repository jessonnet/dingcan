import{o as I,r as u,c as k,d as j,f as l,w as a,h as m,b as V,E as d,e as v,j as r,t as b,q as E,_ as G}from"./index-c314a4a7.js";import{_ as H}from"./_plugin-vue_export-helper-c27b6911.js";const J={class:"meal-type-container"},K={class:"card-header"},L={class:"meal-type-content"},O={class:"dialog-footer"},P={class:"dialog-footer"},Q={__name:"MealType",setup(W){const M=m([]),f=m(!1),y=m(null),i=m({name:"",price:0,status:1}),_=m(!1),x=m(null),p=m({id:"",name:"",price:0,status:1}),T={name:[{required:!0,message:"请输入餐食类型",trigger:"change"}],price:[{required:!0,message:"请输入价格",trigger:"change"}],status:[{required:!0,message:"请选择状态",trigger:"change"}]},g=async()=>{try{const o=await V.get("/api/admin/meal-type/list");o.success?M.value=o.data:d.error("加载餐食类型失败")}catch{d.error("加载餐食类型失败，请检查网络连接")}},$=async()=>{y.value&&await y.value.validate(async o=>{if(o)try{const e={...i.value,status:i.value.status?1:0},s=await V.post("/api/admin/meal-type/add",e);s.success?(d.success(s.message),f.value=!1,i.value={name:"",price:0,status:1},y.value.resetFields(),g()):d.error(s.message)}catch{d.error("添加失败，请检查网络连接")}})},q=o=>{p.value={id:o.id,name:o.name,price:o.price,status:o.status},_.value=!0},R=async()=>{x.value&&await x.value.validate(async o=>{if(o)try{const e={...p.value,status:p.value.status?1:0},s=await V.put("/api/admin/meal-type/update",e);s.success?(d.success(s.message),_.value=!1,g()):d.error(s.message)}catch{d.error("编辑失败，请检查网络连接")}})},A=async o=>{var e,s;try{await G.confirm("确定要删除该餐食类型吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const n=await V.delete(`/api/admin/meal-type/delete/${o}`);n.success?(d.success(n.message),g()):d.error(n.message)}catch(n){if(n!=="cancel"){console.error("删除餐食类型失败:",n);const w=n.message||((s=(e=n.response)==null?void 0:e.data)==null?void 0:s.message)||"删除失败，请检查网络连接";d.error(w)}}};return I(()=>{g()}),(o,e)=>{const s=u("el-button"),n=u("el-table-column"),w=u("el-tag"),N=u("el-table"),S=u("el-card"),C=u("el-input"),c=u("el-form-item"),U=u("el-input-number"),B=u("el-switch"),D=u("el-form"),F=u("el-dialog");return k(),j("div",J,[l(S,null,{header:a(()=>[v("div",K,[e[12]||(e[12]=v("span",null,"餐食类型管理",-1)),l(s,{type:"primary",onClick:e[0]||(e[0]=t=>f.value=!0)},{default:a(()=>[...e[11]||(e[11]=[r("添加餐食类型",-1)])]),_:1})])]),default:a(()=>[v("div",L,[l(N,{data:M.value,style:{width:"100%"}},{default:a(()=>[l(n,{prop:"id",label:"ID",width:"80"},{default:a(t=>[r(b(t.row.id),1)]),_:1}),l(n,{prop:"name",label:"餐食类型",width:"180"},{default:a(t=>[r(b(t.row.name),1)]),_:1}),l(n,{prop:"price",label:"价格",width:"100"},{default:a(t=>[r(" ¥"+b(t.row.price),1)]),_:1}),l(n,{prop:"status",label:"状态",width:"100"},{default:a(t=>[t.row.status===1?(k(),E(w,{key:0,type:"success"},{default:a(()=>[...e[13]||(e[13]=[r("启用",-1)])]),_:1})):(k(),E(w,{key:1,type:"danger"},{default:a(()=>[...e[14]||(e[14]=[r("禁用",-1)])]),_:1}))]),_:1}),l(n,{prop:"createdAt",label:"创建时间",width:"200"},{default:a(t=>[r(b(t.row.createdAt),1)]),_:1}),l(n,{label:"操作",width:"150"},{default:a(t=>[l(s,{type:"primary",size:"small",onClick:z=>q(t.row)},{default:a(()=>[...e[15]||(e[15]=[r("编辑",-1)])]),_:1},8,["onClick"]),l(s,{type:"danger",size:"small",onClick:z=>A(t.row.id)},{default:a(()=>[...e[16]||(e[16]=[r("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])])]),_:1}),l(F,{modelValue:f.value,"onUpdate:modelValue":e[5]||(e[5]=t=>f.value=t),title:"添加餐食类型",width:"500px"},{footer:a(()=>[v("span",O,[l(s,{onClick:e[4]||(e[4]=t=>f.value=!1)},{default:a(()=>[...e[17]||(e[17]=[r("取消",-1)])]),_:1}),l(s,{type:"primary",onClick:$},{default:a(()=>[...e[18]||(e[18]=[r("确定",-1)])]),_:1})])]),default:a(()=>[l(D,{model:i.value,rules:T,ref_key:"addMealTypeFormRef",ref:y,"label-width":"100px"},{default:a(()=>[l(c,{label:"餐食类型",prop:"name"},{default:a(()=>[l(C,{modelValue:i.value.name,"onUpdate:modelValue":e[1]||(e[1]=t=>i.value.name=t),placeholder:"输入餐食类型"},null,8,["modelValue"])]),_:1}),l(c,{label:"价格",prop:"price"},{default:a(()=>[l(U,{modelValue:i.value.price,"onUpdate:modelValue":e[2]||(e[2]=t=>i.value.price=t),min:0,step:.01,precision:2,placeholder:"输入价格"},null,8,["modelValue"])]),_:1}),l(c,{label:"状态",prop:"status"},{default:a(()=>[l(B,{modelValue:i.value.status,"onUpdate:modelValue":e[3]||(e[3]=t=>i.value.status=t),"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),l(F,{modelValue:_.value,"onUpdate:modelValue":e[10]||(e[10]=t=>_.value=t),title:"编辑餐食类型",width:"500px"},{footer:a(()=>[v("span",P,[l(s,{onClick:e[9]||(e[9]=t=>_.value=!1)},{default:a(()=>[...e[19]||(e[19]=[r("取消",-1)])]),_:1}),l(s,{type:"primary",onClick:R},{default:a(()=>[...e[20]||(e[20]=[r("确定",-1)])]),_:1})])]),default:a(()=>[l(D,{model:p.value,rules:T,ref_key:"editMealTypeFormRef",ref:x,"label-width":"100px"},{default:a(()=>[l(c,{label:"餐食类型",prop:"name"},{default:a(()=>[l(C,{modelValue:p.value.name,"onUpdate:modelValue":e[6]||(e[6]=t=>p.value.name=t),placeholder:"输入餐食类型"},null,8,["modelValue"])]),_:1}),l(c,{label:"价格",prop:"price"},{default:a(()=>[l(U,{modelValue:p.value.price,"onUpdate:modelValue":e[7]||(e[7]=t=>p.value.price=t),min:0,step:.01,precision:2,placeholder:"输入价格"},null,8,["modelValue"])]),_:1}),l(c,{label:"状态",prop:"status"},{default:a(()=>[l(B,{modelValue:p.value.status,"onUpdate:modelValue":e[8]||(e[8]=t=>p.value.status=t),"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},Z=H(Q,[["__scopeId","data-v-c7f45393"]]);export{Z as default};
