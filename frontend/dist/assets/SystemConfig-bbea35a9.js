import{g as V,r as m,o as S,c as w,b as a,w as r,j as y,E as i,a as p,f as v,d as _}from"./index-f2900ff4.js";import{_ as T}from"./_plugin-vue_export-helper-c27b6911.js";const b={class:"system-config-container"},I={class:"system-config-content"},D={__name:"SystemConfig",setup(H){const k=_(null),n=_({lockTime:"",systemName:""}),u=_({lock_time:"",system_name:""}),C={lockTime:[{required:!0,message:"请选择锁单时间",trigger:"change"}],systemName:[{required:!0,message:"请输入系统名称",trigger:"change"}]},x=async()=>{try{console.log("开始加载系统配置");const t=await y.get("/api/admin/system-config/list");if(console.log("加载系统配置响应:",t),t.success){const e=t.data;console.log("系统配置数据:",e);for(const o of e)if(o.configKey==="lock_time"){u.value.lock_time=o.id;const s=o.configValue.split(":"),l=new Date;l.setHours(parseInt(s[0]),parseInt(s[1]),0,0),n.value.lockTime=l}else o.configKey==="system_name"&&(u.value.system_name=o.id,n.value.systemName=o.configValue)}else i.error("加载系统配置失败")}catch(t){console.error("加载系统配置失败:",t),i.error("加载系统配置失败，请检查网络连接")}},g=async(t,e)=>{try{console.log("开始更新系统配置:",t,e);let o=e;if(t==="lock_time"&&e instanceof Date){const d=e.getHours().toString().padStart(2,"0"),f=e.getMinutes().toString().padStart(2,"0");o=`${d}:${f}`}const s=u.value[t];if(console.log("配置项 ID:",s),!s){i.error("未找到配置项的 ID，请重新加载页面");return}console.log("准备发送更新请求:",{id:s,configKey:t,configValue:o});const l=await y.put("/api/admin/system-config/update",{id:s,configKey:t,configValue:o});console.log("更新系统配置响应:",l),l.success?i.success(l.message):i.error(l.message)}catch(o){console.error("更新系统配置失败:",o),i.error("更新系统配置失败，请检查网络连接")}};return V(()=>{x()}),(t,e)=>{const o=m("el-time-picker"),s=m("el-button"),l=m("el-form-item"),d=m("el-input"),f=m("el-form"),N=m("el-card");return S(),w("div",b,[a(N,null,{header:r(()=>[...e[4]||(e[4]=[p("div",{class:"card-header"},[p("span",null,"系统配置")],-1)])]),default:r(()=>[p("div",I,[a(f,{model:n.value,rules:C,ref_key:"systemConfigFormRef",ref:k,"label-width":"150px"},{default:r(()=>[a(l,{label:"锁单时间",prop:"lockTime"},{default:r(()=>[a(o,{modelValue:n.value.lockTime,"onUpdate:modelValue":e[0]||(e[0]=c=>n.value.lockTime=c),format:"HH:mm",placeholder:"选择锁单时间",style:{width:"150px"}},null,8,["modelValue"]),a(s,{type:"primary",onClick:e[1]||(e[1]=c=>g("lock_time",n.value.lockTime)),style:{"margin-left":"10px"}},{default:r(()=>[...e[5]||(e[5]=[v("保存",-1)])]),_:1})]),_:1}),a(l,{label:"系统名称",prop:"systemName"},{default:r(()=>[a(d,{modelValue:n.value.systemName,"onUpdate:modelValue":e[2]||(e[2]=c=>n.value.systemName=c),placeholder:"输入系统名称",style:{width:"300px"}},null,8,["modelValue"]),a(s,{type:"primary",onClick:e[3]||(e[3]=c=>g("system_name",n.value.systemName)),style:{"margin-left":"10px"}},{default:r(()=>[...e[6]||(e[6]=[v("保存",-1)])]),_:1})]),_:1})]),_:1},8,["model"])])]),_:1})])}}},E=T(D,[["__scopeId","data-v-f7f573ea"]]);export{E as default};
