import{o as Q,r as p,G as W,c as D,d as X,f as t,w as l,h as r,b,E as c,e as v,j as s,Z as M,H as Y,q as U,t as B,_ as ee}from"./index-c314a4a7.js";import{_ as ae}from"./_plugin-vue_export-helper-c27b6911.js";const te={class:"restaurant-container"},le={class:"card-header"},oe={class:"search-bar"},ne={class:"restaurant-content"},se={class:"dialog-footer"},re={class:"dialog-footer"},ie={__name:"Restaurant",setup(ue){const h=r([]),C=r(!1),_=r(1),w=r(10),S=r(0),V=r(""),x=r(""),y=r(!1),R=r(null),u=r({name:"",location:"",crossDepartmentBooking:!1}),k=r(!1),z=r(null),i=r({id:"",name:"",location:"",crossDepartmentBooking:!1}),E={name:[{required:!0,message:"请输入餐厅名称",trigger:"change"},{max:50,message:"餐厅名称最多50字符",trigger:"change"}],location:[{required:!0,message:"请输入地点",trigger:"change"},{max:100,message:"地点最多100字符",trigger:"change"}],crossDepartmentBooking:[{required:!0,message:"请选择是否可跨部门预订",trigger:"change"}]},d=async()=>{C.value=!0;try{const o={page:_.value,pageSize:w.value};V.value&&(o.name=V.value),x.value&&(o.location=x.value);const e=await b.get("/api/admin/restaurant/list",{params:o});e.success?(h.value=e.data,S.value=e.total):c.error("加载餐厅列表失败")}catch{c.error("加载餐厅列表失败，请检查网络连接")}finally{C.value=!1}},j=o=>{w.value=o,_.value=1,d()},A=o=>{_.value=o,d()},K=async()=>{if(R.value)try{await R.value.validate();const o={name:u.value.name,location:u.value.location,crossDepartmentBooking:u.value.crossDepartmentBooking?1:0},e=await b.post("/api/admin/restaurant/add",o);e.success?(c.success("添加餐厅成功"),y.value=!1,u.value={name:"",location:"",crossDepartmentBooking:!1},d()):c.error(e.message||"添加餐厅失败")}catch(o){o!==!1&&c.error("添加餐厅失败，请检查网络连接")}},T=o=>{i.value={id:o.id,name:o.name,location:o.location,crossDepartmentBooking:o.crossDepartmentBooking===1},k.value=!0},I=async()=>{if(z.value)try{await z.value.validate();const o={id:i.value.id,name:i.value.name,location:i.value.location,crossDepartmentBooking:i.value.crossDepartmentBooking?1:0},e=await b.put("/api/admin/restaurant/update",o);e.success?(c.success("修改餐厅成功"),k.value=!1,d()):c.error(e.message||"修改餐厅失败")}catch(o){o!==!1&&c.error("修改餐厅失败，请检查网络连接")}},L=async o=>{var e,m;try{await ee.confirm("确定要删除该餐厅吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const n=await b.delete(`/api/admin/restaurant/delete/${o}`);n.success?(c.success("删除餐厅成功"),d()):c.error(n.message||"删除餐厅失败")}catch(n){if(n!=="cancel"){console.error("删除餐厅失败:",n);const g=n.message||((m=(e=n.response)==null?void 0:e.data)==null?void 0:m.message)||"删除餐厅失败，请检查网络连接";c.error(g)}}},P=o=>o?new Date(o).toLocaleString("zh-CN"):"";return Q(()=>{d()}),(o,e)=>{const m=p("el-button"),n=p("el-input"),g=p("el-table-column"),F=p("el-tag"),G=p("el-table"),H=p("el-pagination"),Z=p("el-card"),f=p("el-form-item"),$=p("el-switch"),N=p("el-form"),q=p("el-dialog"),J=W("loading");return D(),X("div",te,[t(Z,null,{header:l(()=>[v("div",le,[e[16]||(e[16]=v("span",null,"餐厅管理",-1)),t(m,{type:"primary",onClick:e[0]||(e[0]=a=>y.value=!0)},{default:l(()=>[...e[15]||(e[15]=[s("添加餐厅",-1)])]),_:1})])]),default:l(()=>[v("div",oe,[t(n,{modelValue:V.value,"onUpdate:modelValue":e[1]||(e[1]=a=>V.value=a),placeholder:"搜索餐厅名称",clearable:"",style:{width:"200px","margin-right":"10px"},onClear:d,onKeyup:M(d,["enter"])},null,8,["modelValue"]),t(n,{modelValue:x.value,"onUpdate:modelValue":e[2]||(e[2]=a=>x.value=a),placeholder:"搜索地点",clearable:"",style:{width:"200px","margin-right":"10px"},onClear:d,onKeyup:M(d,["enter"])},null,8,["modelValue"]),t(m,{type:"primary",onClick:d},{default:l(()=>[...e[17]||(e[17]=[s("搜索",-1)])]),_:1})]),v("div",ne,[Y((D(),U(G,{data:h.value,style:{width:"100%"}},{default:l(()=>[t(g,{prop:"id",label:"ID",width:"80"},{default:l(a=>[s(B(a.row.id),1)]),_:1}),t(g,{prop:"name",label:"餐厅名称",width:"150"},{default:l(a=>[s(B(a.row.name),1)]),_:1}),t(g,{prop:"location",label:"地点",width:"200"},{default:l(a=>[s(B(a.row.location),1)]),_:1}),t(g,{prop:"crossDepartmentBooking",label:"跨部门预订",width:"120"},{default:l(a=>[a.row.crossDepartmentBooking===1?(D(),U(F,{key:0,type:"success"},{default:l(()=>[...e[18]||(e[18]=[s("是",-1)])]),_:1})):(D(),U(F,{key:1,type:"info"},{default:l(()=>[...e[19]||(e[19]=[s("否",-1)])]),_:1}))]),_:1}),t(g,{prop:"createdAt",label:"创建时间",width:"180"},{default:l(a=>[s(B(P(a.row.createdAt)),1)]),_:1}),t(g,{label:"操作",width:"150"},{default:l(a=>[t(m,{type:"primary",size:"small",onClick:O=>T(a.row)},{default:l(()=>[...e[20]||(e[20]=[s("编辑",-1)])]),_:1},8,["onClick"]),t(m,{type:"danger",size:"small",onClick:O=>L(a.row.id)},{default:l(()=>[...e[21]||(e[21]=[s("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[J,C.value]]),t(H,{"current-page":_.value,"onUpdate:currentPage":e[3]||(e[3]=a=>_.value=a),"page-size":w.value,"onUpdate:pageSize":e[4]||(e[4]=a=>w.value=a),"page-sizes":[10,20,50,100],total:S.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:j,onCurrentChange:A,style:{"margin-top":"20px","justify-content":"flex-end"}},null,8,["current-page","page-size","total"])])]),_:1}),t(q,{modelValue:y.value,"onUpdate:modelValue":e[9]||(e[9]=a=>y.value=a),title:"添加餐厅",width:"500px","close-on-click-modal":!1},{footer:l(()=>[v("span",se,[t(m,{onClick:e[8]||(e[8]=a=>y.value=!1)},{default:l(()=>[...e[22]||(e[22]=[s("取消",-1)])]),_:1}),t(m,{type:"primary",onClick:K},{default:l(()=>[...e[23]||(e[23]=[s("确定",-1)])]),_:1})])]),default:l(()=>[t(N,{model:u.value,rules:E,ref_key:"addRestaurantFormRef",ref:R,"label-width":"100px"},{default:l(()=>[t(f,{label:"餐厅名称",prop:"name"},{default:l(()=>[t(n,{modelValue:u.value.name,"onUpdate:modelValue":e[5]||(e[5]=a=>u.value.name=a),placeholder:"输入餐厅名称（最多50字符）",maxlength:"50"},null,8,["modelValue"])]),_:1}),t(f,{label:"地点",prop:"location"},{default:l(()=>[t(n,{modelValue:u.value.location,"onUpdate:modelValue":e[6]||(e[6]=a=>u.value.location=a),type:"textarea",rows:2,placeholder:"输入地点（最多100字符）",maxlength:"100"},null,8,["modelValue"])]),_:1}),t(f,{label:"跨部门预订",prop:"crossDepartmentBooking"},{default:l(()=>[t($,{modelValue:u.value.crossDepartmentBooking,"onUpdate:modelValue":e[7]||(e[7]=a=>u.value.crossDepartmentBooking=a),"active-text":"是","inactive-text":"否"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),t(q,{modelValue:k.value,"onUpdate:modelValue":e[14]||(e[14]=a=>k.value=a),title:"编辑餐厅",width:"500px","close-on-click-modal":!1},{footer:l(()=>[v("span",re,[t(m,{onClick:e[13]||(e[13]=a=>k.value=!1)},{default:l(()=>[...e[24]||(e[24]=[s("取消",-1)])]),_:1}),t(m,{type:"primary",onClick:I},{default:l(()=>[...e[25]||(e[25]=[s("确定",-1)])]),_:1})])]),default:l(()=>[t(N,{model:i.value,rules:E,ref_key:"editRestaurantFormRef",ref:z,"label-width":"100px"},{default:l(()=>[t(f,{label:"餐厅名称",prop:"name"},{default:l(()=>[t(n,{modelValue:i.value.name,"onUpdate:modelValue":e[10]||(e[10]=a=>i.value.name=a),placeholder:"输入餐厅名称（最多50字符）",maxlength:"50"},null,8,["modelValue"])]),_:1}),t(f,{label:"地点",prop:"location"},{default:l(()=>[t(n,{modelValue:i.value.location,"onUpdate:modelValue":e[11]||(e[11]=a=>i.value.location=a),type:"textarea",rows:2,placeholder:"输入地点（最多100字符）",maxlength:"100"},null,8,["modelValue"])]),_:1}),t(f,{label:"跨部门预订",prop:"crossDepartmentBooking"},{default:l(()=>[t($,{modelValue:i.value.crossDepartmentBooking,"onUpdate:modelValue":e[12]||(e[12]=a=>i.value.crossDepartmentBooking=a),"active-text":"是","inactive-text":"否"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},pe=ae(ie,[["__scopeId","data-v-e698e5a5"]]);export{pe as default};
