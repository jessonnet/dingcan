import{i as P,r as p,o as i,c as y,b as a,w as t,d as g,m as _,E as m,a as I,f as u,t as V,j as w,F as q,A as x}from"./index-cf2541ee.js";import{_ as Q}from"./_plugin-vue_export-helper-c27b6911.js";const W={class:"employee-container"},X={class:"card-header"},Y={class:"employee-content"},Z={class:"dialog-footer"},ee={class:"dialog-footer"},le={__name:"Employee",setup(ae){const N=g([]),C=g([]),F=g([]),b=g(!1),h=g(null),r=g({username:"",password:"",name:"",departmentId:"",roleId:"",phone:"",email:"",status:1}),c=g(!1),D=g(null),s=g({id:"",username:"",password:"",name:"",departmentId:"",roleId:"",phone:"",email:"",status:1}),z={username:[{required:!0,message:"请输入用户名",trigger:"change"}],password:[{required:!0,message:"请输入密码",trigger:"change"}],name:[{required:!0,message:"请输入姓名",trigger:"change"}],departmentId:[{required:!1,message:"请选择部门",trigger:"change"}],roleId:[{required:!0,message:"请选择角色",trigger:"change"}],phone:[{required:!0,message:"请输入手机号",trigger:"change"}],email:[{type:"email",message:"请输入正确的邮箱格式",trigger:"change",required:!1}],status:[{required:!0,message:"请选择状态",trigger:"change"}]},A={username:[{required:!0,message:"请输入用户名",trigger:"change"}],password:[{validator:(o,e,d)=>{e&&e.length<6?d(new Error("密码长度不能少于6位")):d()},trigger:"change"}],name:[{required:!0,message:"请输入姓名",trigger:"change"}],departmentId:[{required:!1,message:"请选择部门",trigger:"change"}],roleId:[{required:!0,message:"请选择角色",trigger:"change"}],phone:[{required:!0,message:"请输入手机号",trigger:"change"}],email:[{type:"email",message:"请输入正确的邮箱格式",trigger:"change",required:!1}],status:[{required:!0,message:"请选择状态",trigger:"change"}]},k=async()=>{try{const o=await _.get("/api/admin/user/list");o.success?N.value=o.data:m.error("加载员工列表失败")}catch{m.error("加载员工列表失败，请检查网络连接")}},M=async()=>{try{const o=await _.get("/api/admin/role/list");o.success?C.value=o.data:m.error("加载角色列表失败")}catch{m.error("加载角色列表失败，请检查网络连接")}},j=async()=>{try{const o=await _.get("/api/admin/department/enabled");o.success?F.value=o.data:m.error("加载部门列表失败")}catch{m.error("加载部门列表失败，请检查网络连接")}},L=async()=>{h.value&&await h.value.validate(async o=>{if(o)try{const e={...r.value,status:r.value.status?1:0},d=await _.post("/api/admin/user/add",e);d.success?(m.success(d.message),b.value=!1,r.value={username:"",password:"",name:"",departmentId:"",roleId:"",phone:"",email:"",status:1},h.value.resetFields(),k()):m.error(d.message)}catch{m.error("添加失败，请检查网络连接")}})},T=o=>{s.value={id:o.id,username:o.username,password:"",name:o.name,departmentId:o.departmentId,roleId:o.roleId,phone:o.phone,email:o.email,status:o.status},c.value=!0},G=async()=>{D.value&&await D.value.validate(async o=>{if(o)try{const e={...s.value,status:s.value.status?1:0},d=await _.put("/api/admin/user/update",e);d.success?(m.success(d.message),c.value=!1,k()):m.error(d.message)}catch{m.error("编辑失败，请检查网络连接")}})},H=async o=>{try{const e=await _.delete(`/api/admin/user/delete/${o}`);e.success?(m.success(e.message),k()):m.error(e.message)}catch{m.error("删除失败，请检查网络连接")}};return P(()=>{k(),M(),j()}),(o,e)=>{const d=p("el-button"),f=p("el-table-column"),R=p("el-tag"),J=p("el-table"),K=p("el-card"),v=p("el-input"),n=p("el-form-item"),E=p("el-option"),U=p("el-select"),$=p("el-switch"),B=p("el-form"),S=p("el-dialog");return i(),y("div",W,[a(K,null,{header:t(()=>[I("div",X,[e[22]||(e[22]=I("span",null,"员工管理",-1)),a(d,{type:"primary",onClick:e[0]||(e[0]=l=>b.value=!0)},{default:t(()=>[...e[21]||(e[21]=[u("添加员工",-1)])]),_:1})])]),default:t(()=>[I("div",Y,[a(J,{data:N.value,style:{width:"100%"}},{default:t(()=>[a(f,{prop:"id",label:"ID",width:"80"},{default:t(l=>[u(V(l.row.id),1)]),_:1}),a(f,{prop:"username",label:"用户名",width:"150"},{default:t(l=>[u(V(l.row.username),1)]),_:1}),a(f,{prop:"name",label:"姓名",width:"120"},{default:t(l=>[u(V(l.row.name),1)]),_:1}),a(f,{prop:"departmentName",label:"部门",width:"150"},{default:t(l=>[u(V(l.row.departmentName),1)]),_:1}),a(f,{prop:"roleName",label:"角色",width:"120"},{default:t(l=>[u(V(l.row.roleName),1)]),_:1}),a(f,{prop:"phone",label:"手机号",width:"150"},{default:t(l=>[u(V(l.row.phone),1)]),_:1}),a(f,{prop:"email",label:"邮箱",width:"200"},{default:t(l=>[u(V(l.row.email),1)]),_:1}),a(f,{prop:"balance",label:"余额",width:"100"},{default:t(l=>[u(V(l.row.balance||0),1)]),_:1}),a(f,{prop:"status",label:"状态",width:"100"},{default:t(l=>[l.row.status===1?(i(),w(R,{key:0,type:"success"},{default:t(()=>[...e[23]||(e[23]=[u("启用",-1)])]),_:1})):(i(),w(R,{key:1,type:"danger"},{default:t(()=>[...e[24]||(e[24]=[u("禁用",-1)])]),_:1}))]),_:1}),a(f,{label:"操作",width:"150"},{default:t(l=>[a(d,{type:"primary",size:"small",onClick:O=>T(l.row)},{default:t(()=>[...e[25]||(e[25]=[u("编辑",-1)])]),_:1},8,["onClick"]),a(d,{type:"danger",size:"small",onClick:O=>H(l.row.id)},{default:t(()=>[...e[26]||(e[26]=[u("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])])]),_:1}),a(S,{modelValue:b.value,"onUpdate:modelValue":e[10]||(e[10]=l=>b.value=l),title:"添加员工",width:"500px"},{footer:t(()=>[I("span",Z,[a(d,{onClick:e[9]||(e[9]=l=>b.value=!1)},{default:t(()=>[...e[27]||(e[27]=[u("取消",-1)])]),_:1}),a(d,{type:"primary",onClick:L},{default:t(()=>[...e[28]||(e[28]=[u("确定",-1)])]),_:1})])]),default:t(()=>[a(B,{model:r.value,rules:z,ref_key:"addEmployeeFormRef",ref:h,"label-width":"100px"},{default:t(()=>[a(n,{label:"用户名",prop:"username"},{default:t(()=>[a(v,{modelValue:r.value.username,"onUpdate:modelValue":e[1]||(e[1]=l=>r.value.username=l),placeholder:"输入用户名"},null,8,["modelValue"])]),_:1}),a(n,{label:"密码",prop:"password"},{default:t(()=>[a(v,{modelValue:r.value.password,"onUpdate:modelValue":e[2]||(e[2]=l=>r.value.password=l),type:"password",placeholder:"输入密码"},null,8,["modelValue"])]),_:1}),a(n,{label:"姓名",prop:"name"},{default:t(()=>[a(v,{modelValue:r.value.name,"onUpdate:modelValue":e[3]||(e[3]=l=>r.value.name=l),placeholder:"输入姓名"},null,8,["modelValue"])]),_:1}),a(n,{label:"部门",prop:"departmentId"},{default:t(()=>[a(U,{modelValue:r.value.departmentId,"onUpdate:modelValue":e[4]||(e[4]=l=>r.value.departmentId=l),placeholder:"选择部门",clearable:""},{default:t(()=>[(i(!0),y(q,null,x(F.value,l=>(i(),w(E,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(n,{label:"角色",prop:"roleId"},{default:t(()=>[a(U,{modelValue:r.value.roleId,"onUpdate:modelValue":e[5]||(e[5]=l=>r.value.roleId=l),placeholder:"选择角色"},{default:t(()=>[(i(!0),y(q,null,x(C.value,l=>(i(),w(E,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(n,{label:"手机号",prop:"phone"},{default:t(()=>[a(v,{modelValue:r.value.phone,"onUpdate:modelValue":e[6]||(e[6]=l=>r.value.phone=l),placeholder:"输入手机号"},null,8,["modelValue"])]),_:1}),a(n,{label:"邮箱",prop:"email"},{default:t(()=>[a(v,{modelValue:r.value.email,"onUpdate:modelValue":e[7]||(e[7]=l=>r.value.email=l),placeholder:"输入邮箱"},null,8,["modelValue"])]),_:1}),a(n,{label:"状态",prop:"status"},{default:t(()=>[a($,{modelValue:r.value.status,"onUpdate:modelValue":e[8]||(e[8]=l=>r.value.status=l),"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),a(S,{modelValue:c.value,"onUpdate:modelValue":e[20]||(e[20]=l=>c.value=l),title:"编辑员工",width:"500px"},{footer:t(()=>[I("span",ee,[a(d,{onClick:e[19]||(e[19]=l=>c.value=!1)},{default:t(()=>[...e[29]||(e[29]=[u("取消",-1)])]),_:1}),a(d,{type:"primary",onClick:G},{default:t(()=>[...e[30]||(e[30]=[u("确定",-1)])]),_:1})])]),default:t(()=>[a(B,{model:s.value,rules:A,ref_key:"editEmployeeFormRef",ref:D,"label-width":"100px"},{default:t(()=>[a(n,{label:"用户名",prop:"username"},{default:t(()=>[a(v,{modelValue:s.value.username,"onUpdate:modelValue":e[11]||(e[11]=l=>s.value.username=l),placeholder:"输入用户名"},null,8,["modelValue"])]),_:1}),a(n,{label:"密码",prop:"password"},{default:t(()=>[a(v,{modelValue:s.value.password,"onUpdate:modelValue":e[12]||(e[12]=l=>s.value.password=l),type:"password",placeholder:"输入密码（留空则不修改）"},null,8,["modelValue"])]),_:1}),a(n,{label:"姓名",prop:"name"},{default:t(()=>[a(v,{modelValue:s.value.name,"onUpdate:modelValue":e[13]||(e[13]=l=>s.value.name=l),placeholder:"输入姓名"},null,8,["modelValue"])]),_:1}),a(n,{label:"部门",prop:"departmentId"},{default:t(()=>[a(U,{modelValue:s.value.departmentId,"onUpdate:modelValue":e[14]||(e[14]=l=>s.value.departmentId=l),placeholder:"选择部门",clearable:""},{default:t(()=>[(i(!0),y(q,null,x(F.value,l=>(i(),w(E,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(n,{label:"角色",prop:"roleId"},{default:t(()=>[a(U,{modelValue:s.value.roleId,"onUpdate:modelValue":e[15]||(e[15]=l=>s.value.roleId=l),placeholder:"选择角色"},{default:t(()=>[(i(!0),y(q,null,x(C.value,l=>(i(),w(E,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(n,{label:"手机号",prop:"phone"},{default:t(()=>[a(v,{modelValue:s.value.phone,"onUpdate:modelValue":e[16]||(e[16]=l=>s.value.phone=l),placeholder:"输入手机号"},null,8,["modelValue"])]),_:1}),a(n,{label:"邮箱",prop:"email"},{default:t(()=>[a(v,{modelValue:s.value.email,"onUpdate:modelValue":e[17]||(e[17]=l=>s.value.email=l),placeholder:"输入邮箱"},null,8,["modelValue"])]),_:1}),a(n,{label:"状态",prop:"status"},{default:t(()=>[a($,{modelValue:s.value.status,"onUpdate:modelValue":e[18]||(e[18]=l=>s.value.status=l),"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},re=Q(le,[["__scopeId","data-v-d64828ff"]]);export{re as default};
