import{i as I,r,o as D,c as j,b as a,w as l,d as p,m as y,E as n,a as _,f as s,t as V,j as $,n as L}from"./index-cf2541ee.js";import{_ as G}from"./_plugin-vue_export-helper-c27b6911.js";const H={class:"department-container"},J={class:"card-header"},K={class:"department-content"},O={class:"dialog-footer"},P={class:"dialog-footer"},Q={__name:"Department",setup(W){const k=p([]),c=p(!1),b=p(null),d=p({name:"",description:"",status:1}),v=p(!1),x=p(null),u=p({id:"",name:"",description:"",status:1}),C={name:[{required:!0,message:"请输入部门名称",trigger:"change"}],description:[{required:!0,message:"请输入部门描述",trigger:"change"}],status:[{required:!0,message:"请选择状态",trigger:"change"}]},w=async()=>{try{const o=await y.get("/api/admin/department/list");o.success?k.value=o.data:n.error("加载部门列表失败")}catch{n.error("加载部门列表失败，请检查网络连接")}},N=async()=>{if(b.value)try{await b.value.validate();const o=await y.post("/api/admin/department/add",d.value);o.success?(n.success("添加部门成功"),c.value=!1,d.value={name:"",description:"",status:1},w()):n.error(o.message||"添加部门失败")}catch(o){o!==!1&&n.error("添加部门失败，请检查网络连接")}},R=o=>{u.value={id:o.id,name:o.name,description:o.description,status:o.status},v.value=!0},q=async()=>{if(x.value)try{await x.value.validate();const o=await y.put("/api/admin/department/update",u.value);o.success?(n.success("修改部门成功"),v.value=!1,w()):n.error(o.message||"修改部门失败")}catch(o){o!==!1&&n.error("修改部门失败，请检查网络连接")}},z=async o=>{try{await L.confirm("确定要删除该部门吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const e=await y.delete(`/api/admin/department/delete/${o}`);e.success?(n.success("删除部门成功"),w()):n.error(e.message||"删除部门失败")}catch(e){e!=="cancel"&&n.error("删除部门失败，请检查网络连接")}},A=o=>o?new Date(o).toLocaleString("zh-CN"):"";return I(()=>{w()}),(o,e)=>{const i=r("el-button"),m=r("el-table-column"),U=r("el-tag"),M=r("el-table"),S=r("el-card"),g=r("el-input"),f=r("el-form-item"),B=r("el-switch"),E=r("el-form"),F=r("el-dialog");return D(),j("div",H,[a(S,null,{header:l(()=>[_("div",J,[e[12]||(e[12]=_("span",null,"部门设置",-1)),a(i,{type:"primary",onClick:e[0]||(e[0]=t=>c.value=!0)},{default:l(()=>[...e[11]||(e[11]=[s("添加部门",-1)])]),_:1})])]),default:l(()=>[_("div",K,[a(M,{data:k.value,style:{width:"100%"}},{default:l(()=>[a(m,{prop:"id",label:"ID",width:"80"},{default:l(t=>[s(V(t.row.id),1)]),_:1}),a(m,{prop:"name",label:"部门名称",width:"200"},{default:l(t=>[s(V(t.row.name),1)]),_:1}),a(m,{prop:"description",label:"部门描述",width:"300"},{default:l(t=>[s(V(t.row.description),1)]),_:1}),a(m,{prop:"status",label:"状态",width:"100"},{default:l(t=>[t.row.status===1?(D(),$(U,{key:0,type:"success"},{default:l(()=>[...e[13]||(e[13]=[s("启用",-1)])]),_:1})):(D(),$(U,{key:1,type:"danger"},{default:l(()=>[...e[14]||(e[14]=[s("禁用",-1)])]),_:1}))]),_:1}),a(m,{prop:"createdAt",label:"创建时间",width:"180"},{default:l(t=>[s(V(A(t.row.createdAt)),1)]),_:1}),a(m,{label:"操作",width:"150"},{default:l(t=>[a(i,{type:"primary",size:"small",onClick:T=>R(t.row)},{default:l(()=>[...e[15]||(e[15]=[s("编辑",-1)])]),_:1},8,["onClick"]),a(i,{type:"danger",size:"small",onClick:T=>z(t.row.id)},{default:l(()=>[...e[16]||(e[16]=[s("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])])]),_:1}),a(F,{modelValue:c.value,"onUpdate:modelValue":e[5]||(e[5]=t=>c.value=t),title:"添加部门",width:"500px"},{footer:l(()=>[_("span",O,[a(i,{onClick:e[4]||(e[4]=t=>c.value=!1)},{default:l(()=>[...e[17]||(e[17]=[s("取消",-1)])]),_:1}),a(i,{type:"primary",onClick:N},{default:l(()=>[...e[18]||(e[18]=[s("确定",-1)])]),_:1})])]),default:l(()=>[a(E,{model:d.value,rules:C,ref_key:"addDepartmentFormRef",ref:b,"label-width":"100px"},{default:l(()=>[a(f,{label:"部门名称",prop:"name"},{default:l(()=>[a(g,{modelValue:d.value.name,"onUpdate:modelValue":e[1]||(e[1]=t=>d.value.name=t),placeholder:"输入部门名称"},null,8,["modelValue"])]),_:1}),a(f,{label:"部门描述",prop:"description"},{default:l(()=>[a(g,{modelValue:d.value.description,"onUpdate:modelValue":e[2]||(e[2]=t=>d.value.description=t),type:"textarea",rows:3,placeholder:"输入部门描述"},null,8,["modelValue"])]),_:1}),a(f,{label:"状态",prop:"status"},{default:l(()=>[a(B,{modelValue:d.value.status,"onUpdate:modelValue":e[3]||(e[3]=t=>d.value.status=t),"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),a(F,{modelValue:v.value,"onUpdate:modelValue":e[10]||(e[10]=t=>v.value=t),title:"编辑部门",width:"500px"},{footer:l(()=>[_("span",P,[a(i,{onClick:e[9]||(e[9]=t=>v.value=!1)},{default:l(()=>[...e[19]||(e[19]=[s("取消",-1)])]),_:1}),a(i,{type:"primary",onClick:q},{default:l(()=>[...e[20]||(e[20]=[s("确定",-1)])]),_:1})])]),default:l(()=>[a(E,{model:u.value,rules:C,ref_key:"editDepartmentFormRef",ref:x,"label-width":"100px"},{default:l(()=>[a(f,{label:"部门名称",prop:"name"},{default:l(()=>[a(g,{modelValue:u.value.name,"onUpdate:modelValue":e[6]||(e[6]=t=>u.value.name=t),placeholder:"输入部门名称"},null,8,["modelValue"])]),_:1}),a(f,{label:"部门描述",prop:"description"},{default:l(()=>[a(g,{modelValue:u.value.description,"onUpdate:modelValue":e[7]||(e[7]=t=>u.value.description=t),type:"textarea",rows:3,placeholder:"输入部门描述"},null,8,["modelValue"])]),_:1}),a(f,{label:"状态",prop:"status"},{default:l(()=>[a(B,{modelValue:u.value.status,"onUpdate:modelValue":e[8]||(e[8]=t=>u.value.status=t),"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},Z=G(Q,[["__scopeId","data-v-01b0aa8e"]]);export{Z as default};
