import{g as I,r as p,o as k,c as j,b as a,w as l,d as m,j as V,E as u,a as _,f as n,t as b,h as $,X as L}from"./index-bda5bdc9.js";import{_ as X}from"./_plugin-vue_export-helper-c27b6911.js";const G={class:"department-container"},H={class:"card-header"},J={class:"department-content"},K={class:"dialog-footer"},O={class:"dialog-footer"},P={__name:"Department",setup(Q){const C=m([]),c=m(!1),D=m(null),d=m({name:"",description:"",status:1}),v=m(!1),x=m(null),r=m({id:"",name:"",description:"",status:1}),U={name:[{required:!0,message:"请输入部门名称",trigger:"change"}],description:[{required:!0,message:"请输入部门描述",trigger:"change"}],status:[{required:!0,message:"请选择状态",trigger:"change"}]},g=async()=>{try{const o=await V.get("/api/admin/department/list");o.success?C.value=o.data:u.error("加载部门列表失败")}catch{u.error("加载部门列表失败，请检查网络连接")}},M=async()=>{if(D.value)try{await D.value.validate();const o={name:d.value.name,description:d.value.description,status:d.value.status?1:0},e=await V.post("/api/admin/department/add",o);e.success?(u.success("添加部门成功"),c.value=!1,d.value={name:"",description:"",status:1},g()):u.error(e.message||"添加部门失败")}catch(o){o!==!1&&u.error("添加部门失败，请检查网络连接")}},N=o=>{r.value={id:o.id,name:o.name,description:o.description,status:o.status},v.value=!0},R=async()=>{if(x.value)try{await x.value.validate();const o={id:r.value.id,name:r.value.name,description:r.value.description,status:r.value.status?1:0},e=await V.put("/api/admin/department/update",o);e.success?(u.success("修改部门成功"),v.value=!1,g()):u.error(e.message||"修改部门失败")}catch(o){o!==!1&&u.error("修改部门失败，请检查网络连接")}},q=async o=>{var e,i;try{await L.confirm("确定要删除该部门吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const s=await V.delete(`/api/admin/department/delete/${o}`);s.success?(u.success("删除部门成功"),g()):u.error(s.message||"删除部门失败")}catch(s){if(s!=="cancel"){console.error("删除部门失败:",s);const w=s.message||((i=(e=s.response)==null?void 0:e.data)==null?void 0:i.message)||"删除部门失败，请检查网络连接";u.error(w)}}},z=o=>o?new Date(o).toLocaleString("zh-CN"):"";return I(()=>{g()}),(o,e)=>{const i=p("el-button"),s=p("el-table-column"),w=p("el-tag"),A=p("el-table"),S=p("el-card"),y=p("el-input"),f=p("el-form-item"),B=p("el-switch"),E=p("el-form"),F=p("el-dialog");return k(),j("div",G,[a(S,null,{header:l(()=>[_("div",H,[e[12]||(e[12]=_("span",null,"部门设置",-1)),a(i,{type:"primary",onClick:e[0]||(e[0]=t=>c.value=!0)},{default:l(()=>[...e[11]||(e[11]=[n("添加部门",-1)])]),_:1})])]),default:l(()=>[_("div",J,[a(A,{data:C.value,style:{width:"100%"}},{default:l(()=>[a(s,{prop:"id",label:"ID",width:"80"},{default:l(t=>[n(b(t.row.id),1)]),_:1}),a(s,{prop:"name",label:"部门名称",width:"200"},{default:l(t=>[n(b(t.row.name),1)]),_:1}),a(s,{prop:"description",label:"部门描述",width:"300"},{default:l(t=>[n(b(t.row.description),1)]),_:1}),a(s,{prop:"status",label:"状态",width:"100"},{default:l(t=>[t.row.status===1?(k(),$(w,{key:0,type:"success"},{default:l(()=>[...e[13]||(e[13]=[n("启用",-1)])]),_:1})):(k(),$(w,{key:1,type:"danger"},{default:l(()=>[...e[14]||(e[14]=[n("禁用",-1)])]),_:1}))]),_:1}),a(s,{prop:"createdAt",label:"创建时间",width:"180"},{default:l(t=>[n(b(z(t.row.createdAt)),1)]),_:1}),a(s,{label:"操作",width:"150"},{default:l(t=>[a(i,{type:"primary",size:"small",onClick:T=>N(t.row)},{default:l(()=>[...e[15]||(e[15]=[n("编辑",-1)])]),_:1},8,["onClick"]),a(i,{type:"danger",size:"small",onClick:T=>q(t.row.id)},{default:l(()=>[...e[16]||(e[16]=[n("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])])]),_:1}),a(F,{modelValue:c.value,"onUpdate:modelValue":e[5]||(e[5]=t=>c.value=t),title:"添加部门",width:"500px"},{footer:l(()=>[_("span",K,[a(i,{onClick:e[4]||(e[4]=t=>c.value=!1)},{default:l(()=>[...e[17]||(e[17]=[n("取消",-1)])]),_:1}),a(i,{type:"primary",onClick:M},{default:l(()=>[...e[18]||(e[18]=[n("确定",-1)])]),_:1})])]),default:l(()=>[a(E,{model:d.value,rules:U,ref_key:"addDepartmentFormRef",ref:D,"label-width":"100px"},{default:l(()=>[a(f,{label:"部门名称",prop:"name"},{default:l(()=>[a(y,{modelValue:d.value.name,"onUpdate:modelValue":e[1]||(e[1]=t=>d.value.name=t),placeholder:"输入部门名称"},null,8,["modelValue"])]),_:1}),a(f,{label:"部门描述",prop:"description"},{default:l(()=>[a(y,{modelValue:d.value.description,"onUpdate:modelValue":e[2]||(e[2]=t=>d.value.description=t),type:"textarea",rows:3,placeholder:"输入部门描述"},null,8,["modelValue"])]),_:1}),a(f,{label:"状态",prop:"status"},{default:l(()=>[a(B,{modelValue:d.value.status,"onUpdate:modelValue":e[3]||(e[3]=t=>d.value.status=t),"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),a(F,{modelValue:v.value,"onUpdate:modelValue":e[10]||(e[10]=t=>v.value=t),title:"编辑部门",width:"500px"},{footer:l(()=>[_("span",O,[a(i,{onClick:e[9]||(e[9]=t=>v.value=!1)},{default:l(()=>[...e[19]||(e[19]=[n("取消",-1)])]),_:1}),a(i,{type:"primary",onClick:R},{default:l(()=>[...e[20]||(e[20]=[n("确定",-1)])]),_:1})])]),default:l(()=>[a(E,{model:r.value,rules:U,ref_key:"editDepartmentFormRef",ref:x,"label-width":"100px"},{default:l(()=>[a(f,{label:"部门名称",prop:"name"},{default:l(()=>[a(y,{modelValue:r.value.name,"onUpdate:modelValue":e[6]||(e[6]=t=>r.value.name=t),placeholder:"输入部门名称"},null,8,["modelValue"])]),_:1}),a(f,{label:"部门描述",prop:"description"},{default:l(()=>[a(y,{modelValue:r.value.description,"onUpdate:modelValue":e[7]||(e[7]=t=>r.value.description=t),type:"textarea",rows:3,placeholder:"输入部门描述"},null,8,["modelValue"])]),_:1}),a(f,{label:"状态",prop:"status"},{default:l(()=>[a(B,{modelValue:r.value.status,"onUpdate:modelValue":e[8]||(e[8]=t=>r.value.status=t),"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},Z=X(P,[["__scopeId","data-v-41bf06a6"]]);export{Z as default};
