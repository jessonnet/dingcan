import{i as S,r as n,o as q,c as z,b as l,w as t,d as p,m as V,E as s,a as _,f as r,t as b}from"./index-cf2541ee.js";import{_ as I}from"./_plugin-vue_export-helper-c27b6911.js";const M={class:"role-container"},T={class:"card-header"},j={class:"role-content"},G={class:"dialog-footer"},H={class:"dialog-footer"},J={__name:"Role",setup(K){const k=p([]),m=p(!1),v=p(null),d=p({name:"",description:""}),c=p(!1),R=p(null),i=p({id:"",name:"",description:""}),x={name:[{required:!0,message:"请输入角色名称",trigger:"change"}],description:[{required:!0,message:"请输入角色描述",trigger:"change"}]},y=async()=>{try{const a=await V.get("/api/admin/role/list");a.success?k.value=a.data:s.error("加载角色失败")}catch{s.error("加载角色失败，请检查网络连接")}},U=async()=>{v.value&&await v.value.validate(async a=>{if(a)try{const e=await V.post("/api/admin/role/add",d.value);e.success?(s.success(e.message),m.value=!1,d.value={name:"",description:""},v.value.resetFields(),y()):s.error(e.message)}catch{s.error("添加失败，请检查网络连接")}})},$=a=>{i.value={id:a.id,name:a.name,description:a.description},c.value=!0},D=async()=>{R.value&&await R.value.validate(async a=>{if(a)try{const e=await V.put("/api/admin/role/update",i.value);e.success?(s.success(e.message),c.value=!1,y()):s.error(e.message)}catch{s.error("编辑失败，请检查网络连接")}})},E=async a=>{try{const e=await V.delete(`/api/admin/role/delete/${a}`);e.success?(s.success(e.message),y()):s.error(e.message)}catch{s.error("删除失败，请检查网络连接")}};return S(()=>{y()}),(a,e)=>{const u=n("el-button"),f=n("el-table-column"),A=n("el-table"),B=n("el-card"),g=n("el-input"),w=n("el-form-item"),C=n("el-form"),F=n("el-dialog");return q(),z("div",M,[l(B,null,{header:t(()=>[_("div",T,[e[10]||(e[10]=_("span",null,"角色管理",-1)),l(u,{type:"primary",onClick:e[0]||(e[0]=o=>m.value=!0)},{default:t(()=>[...e[9]||(e[9]=[r("添加角色",-1)])]),_:1})])]),default:t(()=>[_("div",j,[l(A,{data:k.value,style:{width:"100%"}},{default:t(()=>[l(f,{prop:"id",label:"ID",width:"80"},{default:t(o=>[r(b(o.row.id),1)]),_:1}),l(f,{prop:"name",label:"角色名称",width:"180"},{default:t(o=>[r(b(o.row.name),1)]),_:1}),l(f,{prop:"description",label:"角色描述"},{default:t(o=>[r(b(o.row.description),1)]),_:1}),l(f,{prop:"createdAt",label:"创建时间",width:"200"},{default:t(o=>[r(b(o.row.createdAt),1)]),_:1}),l(f,{label:"操作",width:"150"},{default:t(o=>[l(u,{type:"primary",size:"small",onClick:N=>$(o.row)},{default:t(()=>[...e[11]||(e[11]=[r("编辑",-1)])]),_:1},8,["onClick"]),l(u,{type:"danger",size:"small",onClick:N=>E(o.row.id)},{default:t(()=>[...e[12]||(e[12]=[r("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])])]),_:1}),l(F,{modelValue:m.value,"onUpdate:modelValue":e[4]||(e[4]=o=>m.value=o),title:"添加角色",width:"500px"},{footer:t(()=>[_("span",G,[l(u,{onClick:e[3]||(e[3]=o=>m.value=!1)},{default:t(()=>[...e[13]||(e[13]=[r("取消",-1)])]),_:1}),l(u,{type:"primary",onClick:U},{default:t(()=>[...e[14]||(e[14]=[r("确定",-1)])]),_:1})])]),default:t(()=>[l(C,{model:d.value,rules:x,ref_key:"addRoleFormRef",ref:v,"label-width":"100px"},{default:t(()=>[l(w,{label:"角色名称",prop:"name"},{default:t(()=>[l(g,{modelValue:d.value.name,"onUpdate:modelValue":e[1]||(e[1]=o=>d.value.name=o),placeholder:"输入角色名称"},null,8,["modelValue"])]),_:1}),l(w,{label:"角色描述",prop:"description"},{default:t(()=>[l(g,{modelValue:d.value.description,"onUpdate:modelValue":e[2]||(e[2]=o=>d.value.description=o),placeholder:"输入角色描述",type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),l(F,{modelValue:c.value,"onUpdate:modelValue":e[8]||(e[8]=o=>c.value=o),title:"编辑角色",width:"500px"},{footer:t(()=>[_("span",H,[l(u,{onClick:e[7]||(e[7]=o=>c.value=!1)},{default:t(()=>[...e[15]||(e[15]=[r("取消",-1)])]),_:1}),l(u,{type:"primary",onClick:D},{default:t(()=>[...e[16]||(e[16]=[r("确定",-1)])]),_:1})])]),default:t(()=>[l(C,{model:i.value,rules:x,ref_key:"editRoleFormRef",ref:R,"label-width":"100px"},{default:t(()=>[l(w,{label:"角色名称",prop:"name"},{default:t(()=>[l(g,{modelValue:i.value.name,"onUpdate:modelValue":e[5]||(e[5]=o=>i.value.name=o),placeholder:"输入角色名称"},null,8,["modelValue"])]),_:1}),l(w,{label:"角色描述",prop:"description"},{default:t(()=>[l(g,{modelValue:i.value.description,"onUpdate:modelValue":e[6]||(e[6]=o=>i.value.description=o),placeholder:"输入角色描述",type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},P=I(J,[["__scopeId","data-v-30c15e98"]]);export{P as default};
